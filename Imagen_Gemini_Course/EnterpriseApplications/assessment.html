<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <title>Module Assessment</title>
    <style type="text/css" media="screen">
		@import url( ../shared/style.css );
	</style>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
	<script src="../shared/contentfunctions.js" type="text/javascript"></script>
</head>
<body onload="initAssessment()">
<h1>Module Assessment: Enterprise Applications</h1>

<div id="assessment">
<p>This assessment tests your understanding of production deployment and best practices. You need to score 70% or higher to proceed.</p>
<div id="questions"></div>
<input type="button" value="Submit Assessment" onclick="submitAssessment()" />
</div>

<div id="results" style="display:none;">
<h2>Assessment Results</h2>
<div id="score"></div>
<div id="feedback"></div>
<input type="button" value="Continue" onclick="continueToNext()" />
</div>

<script src="questions.js" type="text/javascript"></script>
<script type="text/javascript">
var test = new Test();

function initAssessment() {
    // Questions are loaded from questions.js
    displayQuestions();
}

function displayQuestions() {
    var questionsDiv = document.getElementById('questions');
    var html = '';
    
    for (var i = 0; i < test.questions.length; i++) {
        var q = test.questions[i];
        html += '<div class="question">';
        html += '<h3>Question ' + (i + 1) + '</h3>';
        html += '<p>' + q.question + '</p>';
        
        if (q.type === QUESTION_TYPE_CHOICE) {
            for (var j = 0; j < q.choices.length; j++) {
                html += '<div class="answer">';
                html += '<input type="radio" name="q' + i + '" id="q' + i + '_' + j + '" value="' + q.choices[j] + '" />';
                html += '<label for="q' + i + '_' + j + '">' + q.choices[j] + '</label>';
                html += '</div>';
            }
        }
        
        html += '</div>';
    }
    
    questionsDiv.innerHTML = html;
}

function submitAssessment() {
    var score = 0;
    var total = test.questions.length;
    
    for (var i = 0; i < total; i++) {
        var selected = document.querySelector('input[name="q' + i + '"]:checked');
        if (selected && selected.value === test.questions[i].correctAnswer) {
            score++;
        }
    }
    
    var percentage = Math.round((score / total) * 100);
    
    document.getElementById('assessment').style.display = 'none';
    document.getElementById('results').style.display = 'block';
    
    var scoreDiv = document.getElementById('score');
    scoreDiv.innerHTML = '<p>You scored ' + score + ' out of ' + total + ' (' + percentage + '%)</p>';
    
    var feedbackDiv = document.getElementById('feedback');
    if (percentage >= 70) {
        feedbackDiv.innerHTML = '<p style="color: green;">Congratulations! You passed this assessment.</p>';
    } else {
        feedbackDiv.innerHTML = '<p style="color: red;">You need 70% to pass. Please review the material and try again.</p>';
    }
}

function continueToNext() {
    // SCORM navigation
    window.location.href = '../FinalAssessment/assessment.html';
}
</script>
</body>
</html>
