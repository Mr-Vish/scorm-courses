<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <title>2.4 XSS — Java (Spring Boot) vulnerable app</title>
    <style type="text/css" media="screen">
		@import url( ../shared/style.css );
	</style>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
	<script src="../shared/contentfunctions.js" type="text/javascript"></script>
</head>
<body>
<h1>2.4 XSS — Java (Spring Boot) vulnerable app</h1>

<h3><strong>Controller example</strong></h3>

<p>@RestController</p>

<p>public class MessageController {</p>

<p>    private final List&lt;Map&lt;String,String&gt;&gt; msgs = new ArrayList&lt;&gt;();</p>

<p>    @PostMapping(&quot;/post&quot;)</p>

<p>    public String post(@RequestParam String name, @RequestParam String message) {</p>

<p>        Map&lt;String,String&gt; m = Map.of(&quot;name&quot;, name, &quot;message&quot;, message);</p>

<p>        msgs.add(m);</p>

<p>        return &quot;Posted&quot;;</p>

<p>    }</p>

<p>    @GetMapping(&quot;/show&quot;)</p>

<p>    public String show() {</p>

<p>        StringBuilder sb = new StringBuilder(&quot;&lt;html&gt;&lt;body&gt;&lt;h1&gt;Messages&lt;/h1&gt;&lt;ul&gt;&quot;);</p>

<p>        for (Map&lt;String,String&gt; m : msgs) {</p>

<p>            // VULNERABLE: direct string concatenation into HTML</p>

<p>            sb.append(&quot;&lt;li&gt;&lt;b&gt;&quot;).append(m.get(&quot;name&quot;)).append(&quot;&lt;/b&gt;: &quot;).append(m.get(&quot;message&quot;)).append(&quot;&lt;/li&gt;&quot;);</p>

<p>        }</p>

<p>        sb.append(&quot;&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;&quot;);</p>

<p>        return sb.toString();</p>

<p>    }</p>

<p>}</p>

<h3><strong>Exploit</strong></h3>

<p>curl -X POST -d &quot;name=attacker&amp;message=&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&quot; http://localhost:8080/post</p>

<p>curl http://localhost:8080/show</p>

<p>Browser shows alert.</p>

<p><strong>Errors &amp; fixes</strong></p>

<ul>
    <li>If using <code>@RestController</code> returning HTML, browsers will render it; ensure Content-Type correct.
</li>
</ul>

<script type="text/javascript">
</script>
</body>
</html>