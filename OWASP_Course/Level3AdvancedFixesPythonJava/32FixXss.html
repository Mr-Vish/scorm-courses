<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <title>3.2 Fix XSS</title>
    <style type="text/css" media="screen">
		@import url( ../shared/style.css );
	</style>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
	<script src="../shared/contentfunctions.js" type="text/javascript"></script>
</head>
<body>
<h1>3.2 Fix XSS</h1>

<h3><strong>Python (Flask) fix — escape content / use templates with autoescape</strong></h3>

<p>Use Jinja templates (Flask&#x27;s <code>render_template</code>) with autoescaping:</p>

<p>&lt;!-- templates/messages.html --&gt;</p>

<p>&lt;h1&gt;Messages&lt;/h1&gt;</p>

<p>&lt;form method=&quot;post&quot;&gt;</p>

<p>  Name: &lt;input name=&quot;name&quot;&gt;&lt;br&gt;</p>

<p>  Message: &lt;input name=&quot;message&quot;&gt;&lt;input type=&quot;submit&quot;&gt;</p>

<p>&lt;/form&gt;</p>

<p>&lt;ul&gt;</p>

<p>  {% for m in messages %}</p>

<p>    &lt;li&gt;&lt;b&gt;{{ m.name }}&lt;/b&gt;: {{ m.message }}&lt;/li&gt;</p>

<p>  {% endfor %}</p>

<p>&lt;/ul&gt;</p>

<p>And in Flask:</p>

<p>from flask import render_template</p>

<p>return render_template(&#x27;messages.html&#x27;, messages=MESSAGES)</p>

<p>Jinja autoescapes <code>{{ }}</code> by default, so <code>&lt;script&gt;</code> payloads are rendered harmless as text.</p>

<p><strong>Retest</strong>: POST same XSS payload — it should render as escaped text, not run.</p>

<p><strong>Common mistakes</strong></p>

<ul>
    <li>Using <code>render_template_string</code> with untrusted input; avoid or carefully escape.
</li>
</ul>

<h3><strong>Java (Spring Boot) fix — escape outputs / use Thymeleaf</strong></h3>

<p>If using Thymeleaf template:</p>

<p>&lt;p th:text=&quot;${message}&quot;&gt;&lt;/p&gt; &lt;!-- automatically escaped --&gt;</p>

<p>Avoid building HTML via string concatenation. If returning JSON from API, store raw message but ensure web clients sanitize.</p>

<p><strong>Retest</strong>: same payload should not execute.</p>

<script type="text/javascript">
</script>
</body>
</html>