<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-US">
<head>
    <title>Types of Chatbot Memory</title>
    <style type="text/css" media="screen">
		@import url( ../shared/style.css );
	</style>
	<script src="../shared/scormfunctions.js" type="text/javascript"></script>
	<script src="../shared/contentfunctions.js" type="text/javascript"></script>
</head>
<body>
<h1>Types of Chatbot Memory</h1>


<h2>Memory Categories</h2>
<table>
    <tr><th>Type</th><th>Scope</th><th>Implementation</th></tr>
    <tr><td>Buffer memory</td><td>Current conversation</td><td>Full message history in context</td></tr>
    <tr><td>Window memory</td><td>Last N turns</td><td>Sliding window over messages</td></tr>
    <tr><td>Summary memory</td><td>Compressed history</td><td>LLM-generated summaries of older turns</td></tr>
    <tr><td>Entity memory</td><td>Key facts about entities</td><td>Extracted and stored entity information</td></tr>
    <tr><td>Long-term memory</td><td>Cross-conversation</td><td>Persistent store of user preferences and facts</td></tr>
</table>

<h2>Context Window Management</h2>
<p>The key challenge is fitting relevant context into the LLM's context window without exceeding limits or wasting tokens:</p>
<ul>
    <li><strong>Token budget allocation:</strong> Reserve tokens for system prompt, memory, current turn, and response</li>
    <li><strong>Priority ordering:</strong> System prompt > recent messages > summarized history > long-term memory</li>
    <li><strong>Dynamic adjustment:</strong> Include more history for complex conversations, less for simple queries</li>
</ul>

<h2>Summary Memory Implementation</h2>
<div class="code-block">
<pre><code>async def compress_history(messages, max_turns=10):
    if len(messages) <= max_turns:
        return messages

    old_messages = messages[:-max_turns]
    recent_messages = messages[-max_turns:]

    summary = await llm.generate(
        f"Summarize this conversation concisely:\n{format_messages(old_messages)}"
    )

    return [{"role": "system", "content": f"Previous conversation summary: {summary}"}] + recent_messages</code></pre>
</div>


<script type="text/javascript">
</script>
</body>
</html>